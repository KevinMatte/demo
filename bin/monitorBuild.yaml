# See also monitorBuild_commented.yaml which is a commented version of this file.
# I think this version here is easier to read.

# ====================================
"__defaults__":

  skipped: "bin/say.py '_MONITOR_NAME_: Skip file exists. Skipping.' 2>/dev/null"

  started: "bin/say.py '_MONITOR_NAME_: Starting' 2>/dev/null"
  completed:
    - "make build_done >/dev/null"
    - "rm -f tmp/build.locked"
    - "bin/say.py '_MONITOR_NAME_: Completed' 2>/dev/null"
  error:
    - "rm -f tmp/build.locked"
    - "bin/say.py '_MONITOR_NAME_: Error' 2>/dev/null"
  commands: "bin/say.py '_MONITOR_NAME_: Missing commands' 2>/dev/null"

# ====================================
"UI Sources":
  commands:
    - "make update_dot_env"
    - "cd images/demo_ui; bin/build_inc.sh _FILES_"
  searches:
    - name: 'static'
      paths:
        - "images/demo_ui/apps/*/src"
      patterns:
        - '.*\.js$'
        - '.*\.jsx$'
        - '.*\.ts$'
        - '.*\.tsx$'
        - '.*\.css$'
        - '.*\.html$'
        - '.*\.py$'
        - '.*\.php$'
    - name: 'environment'
      paths: ['.env', '.secrets.env']

# ====================================
"UI Mounted":
  commands:
    - "make update_dot_env"
    - "make -C images/demo_ui build_mounted"
  searches:
    - name: 'Makefile'
      paths:
        - "images/demo_ui/apps/*/Makefile"
        - "images/demo_ui/Makefile"

# ====================================
"UI Static":
  commands:
    - "make -C images/demo_ui build_static update_image_build"
  searches:
    - name: 'static'
      paths:
        - "images/demo_ui/apps/*/static"

# ====================================
"monitorBuild YAML Changed":
  commands: "bin/say.py  'Reloading monitorBuild YAML.' 2>/dev/null"
  searches: 'bin/monitorBuild.yaml'
