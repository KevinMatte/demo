# See https://docs.docker.com/reference/compose-file/

services:
  demo_ui:
# #if mounted or local
    image: ${DEMO_UI_IMAGE}:latest
# #else
#    image: localhost:5000/${DEMO_UI_IMAGE}:${DEMO_UI_VERSION}
# #endif
    container_name: demo_ui
# #if mounted or local
    build: images/demo_ui
# #endif
    ports:
      - name: web
        target: 80
        published: "8080"
        protocol: tcp
        app_protocol: http
        mode: host

# #if mounted
#    volumes:
#      - "${DEMO_UI_WWW_PATH}:/var/www"
# #endif

    networks:
      - frontend
      - backend

  demo_mariadb:
# #if mounted or local
    image: demo_mariadb:latest
# #else
#    image: demo_mariadb:${DEMO_MARIADB_VERSION}
# #endif
    container_name: demo_mariadb
    restart: always
    environment:
      MARIADB_ROOT_PASSWORD: "${MARIADB_ROOT_PASSWORD}"
    volumes:
      - "${MARIADB_BACKUP_PATH}:/backup"
      - demo_mariadb_mysql:/var/lib/mysql
    networks:
      - backend

  demo_cpp:
    # #if mounted or local
    image: ${DEMO_CPP_IMAGE}:latest
    # #else
    #    image: localhost:5000/${DEMO_CPP_IMAGE}:${DEMO_CPP_VERSION}
    # #endif
    container_name: demo_cpp
    restart: always
    networks:
      - backend
    ports:
      - '18080:${DEMO_CPP_PORT}'
    environment:
      DEMO_CPP_IMAGE: "${DEMO_CPP_IMAGE}"
      DEMO_CPP_VERSION: "${DEMO_CPP_VERSION}"
      DEMO_CPP_PORT: "${DEMO_CPP_PORT}"
      DEMO_CPP_USER_NAME: "${DEMO_CPP_USER_NAME}"
      DEMO_CPP_USER_ID: "${DEMO_CPP_USER_ID}"
      DEMO_CPP_GROUP_NAME: "${DEMO_CPP_GROUP_NAME}"
      DEMO_CPP_GROUP_ID: "${DEMO_CPP_GROUP_ID}"


  mariadb_admin:
    image: adminer:${MARIADB_ADMINER_VERSION}
    container_name: mariadb_admin
    restart: always
    ports:
      - '8090:8080'

    networks:
      - backend

networks:
  frontend:
  backend:

volumes:
  demo_mariadb_mysql:
    name: demo_mariadb_mysql
